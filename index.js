!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r,a,o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e};r=L.map("map",{preferCanvas:!0}).setView([42.69793,23.321628],13),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'Map data &copy; <createCoordinatesReturn href="http://openstreetmap.org">OpenStreetMap</createCoordinatesReturn> contributors, <createCoordinatesReturn href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</createCoordinatesReturn>, Imagery Â© <createCoordinatesReturn href="http://mapbox.com">Mapbox</createCoordinatesReturn>',maxZoom:18,id:"mapbox.streets-basic",accessToken:"pk.eyJ1IjoiY2hpcHNhbiIsImEiOiJqa0JwV1pnIn0.mvduWzyRdcHxK_QIOpetFg"}).addTo(r);L.control.sidebar("sidebar").addTo(r);a=new L.FeatureGroup,r.addLayer(a);var i=new L.Control.Draw({edit:{featureGroup:a},draw:{circle:!1,circlemarker:!1,marker:!1,polygon:!1,polyline:!1}});r.addControl(i);var c=L.canvas({padding:.5});function s(e,t,n,r){void 0===n&&(n=300),void 0===r&&(r={});o({color:"red"},r);e.forEach(function(e){L.circle(e,{radius:n},o({renderer:c},r)).addTo(t)})}var l=6371e3;function u(e,t,n){void 0===t&&(t=500);var r=Number(t)/l,a=p(Number(n)),o=p(e.lat),i=p(e.lng),c=Math.sin(o),s=Math.cos(o),u=Math.sin(r),d=Math.cos(r),h=Math.sin(a),g=c*d+s*u*Math.cos(a),v=Math.asin(g),m=h*u*s,b=d-c*g,y=i+Math.atan2(m,b);return{point:L.latLng(f(v),(f(y)+540)%360-180)}}function d(e,t){var n=Math.min.apply(Math,e),r=Math.max.apply(Math,e);return n<=t&&t<=r}function p(e){return e*Math.PI/180}function f(e){return 180*e/Math.PI}var h,g,v,m,b;function y(e,t,n){for(var r=e.getEast(),a=[],o=t;a.push(o),d([t.lng,r],o.lng);)o=u(o,n,h.east).point;return a}function w(e,t){return u(u(e,t/2,h.south).point,t/2,h.east).point}!function(e){e[e.east=90]="east",e[e.west=-90]="west",e[e.north=0]="north",e[e.south=180]="south"}(h||(h={})),function(e){e.northWest="NorthWest"}(g||(g={})),b=(new L.FeatureGroup).addTo(r),$("#radius-size").attr("value",150),v=function(e,t){e.clearLayers();var n=document.getElementById("regenerate-btn");n.onclick=function(e,t){t.clearLayers();var n=Number($("#radius-size").val());console.log(n+"m circle radius");var r=function(e){for(var t=[],n=[],r=e.boundingRectangle.getBounds(),a=Object.freeze(r.getNorthWest()),o=a,i=o,c=1;;c++){var s=y(r,i,e.distance);t.push.apply(t,s);var l=w(i,e.distance);if(!d([r.getNorth(),r.getSouth()],o.lat))break;var p=y(r,l,e.distance);p.pop(),n.push.apply(n,p),i=o=u(a,e.distance*c,h.south).point}return{main:t,fillers:n,combined:t.concat(n)}}({boundingRectangle:e,distance:2*n});s(r.main,t,n),s(r.fillers,t,n,{color:"green"});var a=document.getElementById("download-btn");console.log("Generated "+r.combined.length+" circles "),a.onclick=function(){var e={coordinates:r.combined,circleRadius:n};!function(e,t,n){var r=new Blob([e],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(r,t);else{var a=window.document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}(JSON.stringify(e),"coords_"+e.coordinates.length+"_r"+n+".json","application/json")}}.bind(null,t,e),n.click()}.bind(null,b),m=b.clearLayers,r.on("draw:created",function(e){var t=e.layerType,n=e.layer;if("rectangle"!==t)return!0;a.clearLayers(),console.log(t+" drawn");var r=n.getLatLngs()[0];a.addLayer(n),console.log("Boundaries of the area of interest:"),console.log(JSON.stringify(r));var o=L.latLngBounds(r.map(function(e){return[e.lat,e.lng]})),i=L.rectangle(o);v(i)}),r.on("draw:deleted",m)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2VvX3V0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9jb3JlLnRzIiwid2VicGFjazovLy8uL3NyYy9hcHAudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwidmFsdWUiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIm1hcCIsImxheWVyRm9yVXNlclJlY3RhbmdsZXMiLCJMIiwicHJlZmVyQ2FudmFzIiwic2V0VmlldyIsInRpbGVMYXllciIsImF0dHJpYnV0aW9uIiwibWF4Wm9vbSIsImlkIiwiYWNjZXNzVG9rZW4iLCJhZGRUbyIsImNvbnRyb2wiLCJzaWRlYmFyIiwiRmVhdHVyZUdyb3VwIiwiYWRkTGF5ZXIiLCJkcmF3Q29udHJvbCIsIkNvbnRyb2wiLCJEcmF3IiwiZWRpdCIsImZlYXR1cmVHcm91cCIsImRyYXciLCJjaXJjbGUiLCJjaXJjbGVtYXJrZXIiLCJtYXJrZXIiLCJwb2x5Z29uIiwicG9seWxpbmUiLCJhZGRDb250cm9sIiwibXlSZW5kZXJlciIsImNhbnZhcyIsInBhZGRpbmciLCJkcmF3Q2lyY2xlcyIsImNvb3JkcyIsImxheWVyIiwiY2lyY2xlUmFkaXVzIiwiY2lyY2xlT3B0aW9ucyIsIl9fYXNzaWduIiwiY29sb3IiLCJmb3JFYWNoIiwiY29vcmQiLCJyYWRpdXMiLCJyZW5kZXJlciIsIkVBUlRIX1JBRElVUyIsImNhbGN1bGF0ZU5leHRQb2ludCIsImNvb3JkaW5hdGUiLCJkaXN0YW5jZSIsImJlYXJpbmciLCJkZWx0YSIsIk51bWJlciIsInRoZXRhIiwidG9SYWRpYW5zIiwicGhpMSIsImxhdCIsImxhbWJkYTEiLCJsbmciLCJzaW5waGkxIiwiTWF0aCIsInNpbiIsImNvc3BoaTEiLCJjb3MiLCJzaW5kZWx0YSIsImNvc2RlbHRhIiwic2ludGhldGEiLCJzaW5waGkyIiwicGhpMiIsImFzaW4iLCJ5IiwieCIsImxhbWJkYTIiLCJhdGFuMiIsInBvaW50IiwibGF0TG5nIiwidG9EZWdyZWVzIiwiaXNXaXRoaW5Cb3VuZHMiLCJib3VuZHMiLCJudW0iLCJtaW5MYXQiLCJtaW4iLCJhcHBseSIsIm1heExhdCIsIm1heCIsIlBJIiwiQmVhcmluZyIsIlJlY3RhbmdsZVNpZGUiLCJjYWxsYmFja09uUmVjdERyYXduIiwiY2FsbGJhY2tPbkRlbGV0ZSIsImNpcmNsZXNMYXllciIsImNpcmNsZUNvb3Jkc09mUm93IiwiaW5pdGlhbENvb3JkIiwiZWFzdEJvdW5kIiwiZ2V0RWFzdCIsInJlc3VsdCIsImN1cnJlbnRQb3NpdGlvbiIsInB1c2giLCJlYXN0IiwibW92ZVRvU291dGhFYXN0IiwiY3VycmVudFJvd0luaXRpYWwiLCJkaXN0Iiwic291dGgiLCIkIiwiYXR0ciIsImRyYXduUmVjdGFuZ2xlIiwiY2xlYXJMYXllcnMiLCJyZWRyYXdCdG4iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwib25jbGljayIsImJvdW5kaW5nUmVjdGFuZ2xlIiwiY2lyY2xlX3JhZGl1cyIsInZhbCIsImNvbnNvbGUiLCJsb2ciLCJvcHRpb25zIiwiZmlsbGVycyIsInJlY3RCb3VuZHMiLCJnZXRCb3VuZHMiLCJpbml0aWFsUG9pbnQiLCJmcmVlemUiLCJnZXROb3J0aFdlc3QiLCJjdXJyZW50Q29vcmQiLCJyb3ciLCJjdXJyZW50Um93Q2lyY2xlc0Nvb3JkcyIsImZpbGxlckZpcnN0Q29vcmQiLCJnZXROb3J0aCIsImdldFNvdXRoIiwiaGVscGVyUm93Q29vcmRzIiwicG9wIiwibWFpbiIsImNvbWJpbmVkIiwiY29uY2F0IiwiY3JlYXRlQ29vcmRpbmF0ZXMiLCJkb3dubG9hZEJ0biIsImxlbmd0aCIsInRvU2F2ZSIsImNvb3JkaW5hdGVzIiwiZGF0YSIsImZpbGVuYW1lIiwiY29udGVudFR5cGUiLCJibG9iIiwiQmxvYiIsInR5cGUiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJtc1NhdmVPck9wZW5CbG9iIiwibXNTYXZlQmxvYiIsImVsZW0iLCJjcmVhdGVFbGVtZW50IiwiaHJlZiIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImRvd25sb2FkIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJyZW1vdmVDaGlsZCIsInNhdmVGaWxlIiwiSlNPTiIsInN0cmluZ2lmeSIsImJpbmQiLCJvbiIsImUiLCJsYXllclR5cGUiLCJsYXRsbmdzIiwiZ2V0TGF0TG5ncyIsInJlY3RhbmdsZUJvdW5kcyIsImxhdExuZ0JvdW5kcyIsInJlY3RhbmdsZSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBakIsR0FDQVksT0FBQUMsZUFBQWIsRUFBQSxjQUFpRGtCLE9BQUEsS0FJakRwQixFQUFBcUIsRUFBQSxTQUFBbEIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBbUIsV0FDQSxXQUEyQixPQUFBbkIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQVUsRUFBQUMsR0FBc0QsT0FBQVYsT0FBQVcsVUFBQUMsZUFBQW5CLEtBQUFnQixFQUFBQyxJQUd0RHhCLEVBQUEyQixFQUFBLEdBSUEzQixJQUFBNEIsRUFBQSw2Q0NuRVdDLEVBQ0FDLHFLQUdYRCxFQUFNRSxFQUFFRixJQUFJLE9BQVFHLGNBQWMsSUFBT0MsU0FBUyxTQUFXLFdBQVksSUFDekVGLEVBQUVHLFVBQVUsbUZBQ1JDLFlBQWEsaVZBQ2JDLFFBQVMsR0FDVEMsR0FBSSx1QkFDSkMsWUFBYSxzRUFDZEMsTUFBTVYsR0FJS0UsRUFBRVMsUUFBUUMsUUFBUSxXQUFXRixNQUFNVixHQUdqREMsRUFBeUIsSUFBSUMsRUFBRVcsYUFDL0JiLEVBQUljLFNBQVNiLEdBRWIsSUFBSWMsRUFBYyxJQUFJYixFQUFFYyxRQUFRQyxNQUM1QkMsTUFDSUMsYUFBY2xCLEdBRWxCbUIsTUFDSUMsUUFBUSxFQUNSQyxjQUFjLEVBQ2RDLFFBQVEsRUFDUkMsU0FBUyxFQUNUQyxVQUFVLEtBR2xCekIsRUFBSTBCLFdBQVdYLEdBcUNmLElBQUlZLEVBQWF6QixFQUFFMEIsUUFBUUMsUUFBUyxLQVU5QixTQUFBQyxFQUFzQkMsRUFBb0JDLEVBQXFCQyxFQUFvQkMsUUFBcEIsSUFBQUQsTUFBQSxVQUFvQixJQUFBQyxVQUM3RUMsR0FDSkMsTUFBTyxPQUNKRixHQUVQSCxFQUFPTSxRQUFRLFNBQUNDLEdBQ1pwQyxFQUFFbUIsT0FBT2lCLEdBQVFDLE9BQVFOLEdBQWFFLEdBQUdLLFNBQVViLEdBQWVPLElBQWdCeEIsTUFBTXNCLEtDaEZoRyxJQUFNUyxFQUFlLE9BWWYsU0FBQUMsRUFBNkJDLEVBQXNCQyxFQUFnQkMsUUFBaEIsSUFBQUQsTUFBQSxLQUVyRCxJQUFJRSxFQUFRQyxPQUFPSCxHQUFZSCxFQUMzQk8sRUFBUUMsRUFBVUYsT0FBT0YsSUFFekJLLEVBQU9ELEVBQVVOLEVBQVdRLEtBQzVCQyxFQUFVSCxFQUFVTixFQUFXVSxLQUUvQkMsRUFBVUMsS0FBS0MsSUFBSU4sR0FBT08sRUFBVUYsS0FBS0csSUFBSVIsR0FDN0NTLEVBQVdKLEtBQUtDLElBQUlWLEdBQVFjLEVBQVdMLEtBQUtHLElBQUlaLEdBQ2hEZSxFQUFXTixLQUFLQyxJQUFJUixHQUVwQmMsRUFBVVIsRUFBVU0sRUFBV0gsRUFBVUUsRUFGRkosS0FBS0csSUFBSVYsR0FHaERlLEVBQU9SLEtBQUtTLEtBQUtGLEdBQ2pCRyxFQUFJSixFQUFXRixFQUFXRixFQUMxQlMsRUFBSU4sRUFBV04sRUFBVVEsRUFDekJLLEVBQVVmLEVBQVVHLEtBQUthLE1BQU1ILEVBQUdDLEdBSXRDLE9BQ0lHLE1BSHFCbkUsRUFBRW9FLE9BQU9DLEVBQVVSLElBQVFRLEVBQVVKLEdBQVcsS0FBTyxJQUFNLE1Ba0JwRixTQUFBSyxFQUF5QkMsRUFBMEJDLEdBQ3JELElBQUlDLEVBQVNwQixLQUFLcUIsSUFBR0MsTUFBUnRCLEtBQVlrQixHQUFTSyxFQUFTdkIsS0FBS3dCLElBQUdGLE1BQVJ0QixLQUFZa0IsR0FDdkQsT0FBUUUsR0FBVUQsR0FBU0EsR0FBT0ksRUFHdEMsU0FBQTdCLEVBQW1CeUIsR0FDZixPQUFPQSxFQUFNbkIsS0FBS3lCLEdBQUssSUFHM0IsU0FBQVQsRUFBbUJHLEdBQ2YsT0FBYSxJQUFOQSxFQUFZbkIsS0FBS3lCLEdDN0RyQixJQXVHRkMsRUFRQUMsRUYxRXlCQyxFQUFzREMsRUczQjFFQyxFRGlFVixTQUFBQyxFQUEyQmIsRUFBd0JjLEVBQXdCM0MsR0FLdkUsSUFKQSxJQUFNNEMsRUFBWWYsRUFBT2dCLFVBRXJCQyxLQUNBQyxFQUE0QkosRUFFNUJHLEVBQU9FLEtBQUtELEdBT1BuQixHQUFnQmUsRUFBYWxDLElBQUttQyxHQUFZRyxFQUFnQnRDLE1BR25Fc0MsRUFBa0JqRCxFQUFtQmlELEVBQWlCL0MsRUFBVXFDLEVBQVFZLE1BQU14QixNQUdsRixPQUFPcUIsRUFHWCxTQUFBSSxFQUF5QkMsRUFBbUJDLEdBRXhDLE9BQU90RCxFQURVQSxFQUFtQnFELEVBQW1CQyxFQUFPLEVBQUdmLEVBQVFnQixPQUFPNUIsTUFDMUMyQixFQUFPLEVBQUdmLEVBQVFZLE1BQU14QixPQUlsRSxTQUFLWSxHQUNEQSxJQUFBLGdCQUNBQSxJQUFBLGlCQUVBQSxJQUFBLGlCQUNBQSxJQUFBLG1CQUxKLENBQUtBLFdBUUwsU0FBS0MsR0FFREEsRUFBQSxzQkFGSixDQUFLQSxXQ3JHS0csR0FBZSxJQUFJbkYsRUFBRVcsY0FBZUgsTUFBTVYsR0FHaERrRyxFQUFFLGdCQUFnQkMsS0FBSyxRRGJVLEtGcUNQaEIsRUc2QjlCLFNBQTZCRSxFQUFjZSxHQUN2Q2YsRUFBYWdCLGNBRWIsSUFBTUMsRUFBWUMsU0FBU0MsZUFBZSxrQkFDMUNGLEVBQVVHLFFBMUNkLFNBQW9CQyxFQUFnQ3JCLEdBRWhEQSxFQUFhZ0IsY0FHYixJQUFNTSxFQTBDQzVELE9BQU9tRCxFQUFFLGdCQUFnQlUsT0F6Q2hDQyxRQUFRQyxJQUFPSCxFQUFhLG1CQUk1QixJQUFNNUUsRUROSixTQUE0QmdGLEdBUTlCLElBUEEsSUFBTXJCLEtBQXlCc0IsS0FFekJDLEVBQWFGLEVBQVFMLGtCQUFrQlEsWUFDdkNDLEVBQWVsSSxPQUFPbUksT0FBT0gsRUFBV0ksZ0JBRTFDQyxFQUF5QkgsRUFDekJwQixFQUFvQnVCLEVBQ2ZDLEVBQU0sR0FBS0EsSUFBTyxDQUV2QixJQUFJQyxFQUEwQmxDLEVBQWtCMkIsRUFBWWxCLEVBQW1CZ0IsRUFBUW5FLFVBQ3ZGOEMsRUFBT0UsS0FBSWYsTUFBWGEsRUFBZThCLEdBRWYsSUFBSUMsRUFBbUIzQixFQUFnQkMsRUFBbUJnQixFQUFRbkUsVUFFbEUsSUFBSzRCLEdBQWdCeUMsRUFBV1MsV0FBWVQsRUFBV1UsWUFBYUwsRUFBYW5FLEtBQzdFLE1BRUEsSUFBSXlFLEVBQThCdEMsRUFBa0IyQixFQUFZUSxFQUFrQlYsRUFBUW5FLFVBQzFGZ0YsRUFBZ0JDLE1BQ2hCYixFQUFRcEIsS0FBSWYsTUFBWm1DLEVBQWdCWSxHQUdwQjdCLEVBQW9CdUIsRUFBZTVFLEVBQW1CeUUsRUFBY0osRUFBUW5FLFNBQVcyRSxFQUFLdEMsRUFBUWdCLE9BQU81QixNQUUvRyxPQUFReUQsS0FBTXBDLEVBQVFzQixRQUFTQSxFQUFTZSxTQUFVckMsRUFBT3NDLE9BQU9oQixJQ25CakRpQixFQUNYdkIsa0JBQW1CQSxFQUNuQjlELFNBQTBCLEVBQWhCK0QsSUFJZDdFLEVBQVlDLEVBQU8rRixLQUFNekMsRUFBY3NCLEdBQ3ZDN0UsRUFBWUMsRUFBT2lGLFFBQVMzQixFQUFjc0IsR0FBZ0J2RSxNQUFPLFVBRWpFLElBQUk4RixFQUFjM0IsU0FBU0MsZUFBZSxnQkFFMUNLLFFBQVFDLElBQUksYUFBYS9FLEVBQU9nRyxTQUFTSSxPQUFNLGFBRS9DRCxFQUFZekIsUUFBVSxXQUNsQixJQUFNMkIsR0FDRkMsWUFBYXRHLEVBQU9nRyxTQUNwQjlGLGFBQWMwRSxJQWdDMUIsU0FBa0IyQixFQUFNQyxFQUFVQyxHQUM5QixJQUFJQyxFQUFPLElBQUlDLE1BQU1KLElBQVFLLEtBQU1ILElBQ25DLEdBQUlJLE9BQU9DLFVBQVVDLGlCQUNqQkYsT0FBT0MsVUFBVUUsV0FBV04sRUFBTUYsT0FFakMsQ0FDRCxJQUFJUyxFQUFPSixPQUFPckMsU0FBUzBDLGNBQWMsS0FDekNELEVBQUtFLEtBQU9OLE9BQU9PLElBQUlDLGdCQUFnQlgsR0FDdkNPLEVBQUtLLFNBQVdkLEVBQ2hCaEMsU0FBUytDLEtBQUtDLFlBQVlQLEdBQzFCQSxFQUFLUSxRQUNMakQsU0FBUytDLEtBQUtHLFlBQVlULElBekMxQlUsQ0FBU0MsS0FBS0MsVUFBVXhCLEdBQVMsVUFBVUEsRUFBT0MsWUFBWUYsT0FBTSxLQUFLeEIsRUFBYSxRQUFTLHNCQWNwRWtELEtBQUssS0FBTXpELEVBQWdCZixHQUMxRGlCLEVBQVVrRCxTQXJEY0ssS0FBSyxLQUFNeEUsR0htQjZDRCxFR2xCNUVDLEVBQWFnQixZSG9CakJyRyxFQUFJOEosR0FBRyxlQUFnQixTQUFVQyxHQUM3QixJQUFJcEIsRUFBT29CLEVBQUVDLFVBQ1RoSSxFQUFRK0gsRUFBRS9ILE1BQ2QsR0FBYSxjQUFUMkcsRUFDQSxPQUFPLEVBRVgxSSxFQUF1Qm9HLGNBQ3ZCUSxRQUFRQyxJQUFJNkIsRUFBTyxVQUNuQixJQUFJc0IsRUFBVWpJLEVBQU1rSSxhQUFhLEdBQ2pDakssRUFBdUJhLFNBQVNrQixHQUVoQzZFLFFBQVFDLElBQUksdUNBQ1pELFFBQVFDLElBQUk2QyxLQUFLQyxVQUFVSyxJQUczQixJQUFNRSxFQUFrQ2pLLEVBQUVrSyxhQUFhSCxFQUFRakssSUFBSSxTQUFVc0MsR0FDekUsT0FBUUEsRUFBTWEsSUFBS2IsRUFBTWUsUUFHdkJxRCxFQUFpQ3hHLEVBQUVtSyxVQUFVRixHQUduRGhGLEVBQW9CdUIsS0FFeEIxRyxFQUFJOEosR0FBRyxlQUFnQjFFIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBsZXQgbWFwO1xuZXhwb3J0IGxldCBsYXllckZvclVzZXJSZWN0YW5nbGVzO1xuZGVjbGFyZSBsZXQgTDtcbi8vIGFkZCB0aGUgbWFwIHRvIHRoZSBwYWdlXG5tYXAgPSBMLm1hcCgnbWFwJywge3ByZWZlckNhbnZhczogdHJ1ZX0pLnNldFZpZXcoWzQyLjY5NzkzMCwgMjMuMzIxNjI4XSwgMTMpO1xuTC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5wbmc/YWNjZXNzX3Rva2VuPXthY2Nlc3NUb2tlbn0nLCB7XG4gICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGNyZWF0ZUNvb3JkaW5hdGVzUmV0dXJuIGhyZWY9XCJodHRwOi8vb3BlbnN0cmVldG1hcC5vcmdcIj5PcGVuU3RyZWV0TWFwPC9jcmVhdGVDb29yZGluYXRlc1JldHVybj4gY29udHJpYnV0b3JzLCA8Y3JlYXRlQ29vcmRpbmF0ZXNSZXR1cm4gaHJlZj1cImh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LXNhLzIuMC9cIj5DQy1CWS1TQTwvY3JlYXRlQ29vcmRpbmF0ZXNSZXR1cm4+LCBJbWFnZXJ5IMKpIDxjcmVhdGVDb29yZGluYXRlc1JldHVybiBocmVmPVwiaHR0cDovL21hcGJveC5jb21cIj5NYXBib3g8L2NyZWF0ZUNvb3JkaW5hdGVzUmV0dXJuPicsXG4gICAgbWF4Wm9vbTogMTgsXG4gICAgaWQ6ICdtYXBib3guc3RyZWV0cy1iYXNpYycsXG4gICAgYWNjZXNzVG9rZW46ICdway5leUoxSWpvaVkyaHBjSE5oYmlJc0ltRWlPaUpxYTBKd1YxcG5JbjAubXZkdVd6eVJkY0h4S19RSU9wZXRGZydcbn0pLmFkZFRvKG1hcCk7XG5cblxuLy8gdGhlIGNvbGxhcHNpYmxlIHNpZGViYXIgd2l0aCByZWRyYXcvZG93bmxvYWQgZXRjLiBjdXN0b20gYnV0dG9uc1xubGV0IHNpZGViYXIgPSBMLmNvbnRyb2wuc2lkZWJhcignc2lkZWJhcicpLmFkZFRvKG1hcCk7XG5cbi8vIHdoZXJlIHdlIGRyYXcgcmVjdGFuZ2xlc1xubGF5ZXJGb3JVc2VyUmVjdGFuZ2xlcyA9IG5ldyBMLkZlYXR1cmVHcm91cCgpO1xubWFwLmFkZExheWVyKGxheWVyRm9yVXNlclJlY3RhbmdsZXMpO1xuLy8gZW5hYmxlIHRoZSBwbHVnaW4gZm9yIGRyYXdpbmcgb24gdGhlIG1hcFxubGV0IGRyYXdDb250cm9sID0gbmV3IEwuQ29udHJvbC5EcmF3KHtcbiAgICBlZGl0OiB7XG4gICAgICAgIGZlYXR1cmVHcm91cDogbGF5ZXJGb3JVc2VyUmVjdGFuZ2xlc1xuICAgIH0sXG4gICAgZHJhdzoge1xuICAgICAgICBjaXJjbGU6IGZhbHNlLFxuICAgICAgICBjaXJjbGVtYXJrZXI6IGZhbHNlLFxuICAgICAgICBtYXJrZXI6IGZhbHNlLFxuICAgICAgICBwb2x5Z29uOiBmYWxzZSxcbiAgICAgICAgcG9seWxpbmU6IGZhbHNlLFxuICAgIH1cbn0pO1xubWFwLmFkZENvbnRyb2woZHJhd0NvbnRyb2wpO1xuXG4vKipcbiAqIEEgZnVuY3Rpb24gd2hpY2ggY29sbGVjdHMgd2hhdCB0aGUgdXNlciBoYXMgZHJhd24gYW5kIHBhc3MgaXQgdG8gYSBjYWxsYmFja1xuICogQHBhcmFtIHsocmVjdGFuZ2xlOiBSZWN0YW5nbGUpID0+IGFueX0gY2FsbGJhY2tPblJlY3REcmF3blxuICogQHBhcmFtIHsoKSA9PiB2b2lkfSBjYWxsYmFja09uRGVsZXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmFibGVEcmF3aW5nKGNhbGxiYWNrT25SZWN0RHJhd246IChyZWN0YW5nbGU6IEwuUmVjdGFuZ2xlKSA9PiBhbnksIGNhbGxiYWNrT25EZWxldGU6ICgpID0+IHZvaWQpIHtcbiAgICAvLyB0b2RvIGhhbmRsZSBcImVkaXRlZFwiIHRvb1xuICAgIG1hcC5vbignZHJhdzpjcmVhdGVkJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgbGV0IHR5cGUgPSBlLmxheWVyVHlwZSxcbiAgICAgICAgICAgIGxheWVyID0gZS5sYXllcjtcbiAgICAgICAgaWYgKHR5cGUgIT09IFwicmVjdGFuZ2xlXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgbGF5ZXJGb3JVc2VyUmVjdGFuZ2xlcy5jbGVhckxheWVycygpO1xuICAgICAgICBjb25zb2xlLmxvZyh0eXBlICsgXCIgZHJhd25cIik7XG4gICAgICAgIGxldCBsYXRsbmdzID0gbGF5ZXIuZ2V0TGF0TG5ncygpWzBdO1xuICAgICAgICBsYXllckZvclVzZXJSZWN0YW5nbGVzLmFkZExheWVyKGxheWVyKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIkJvdW5kYXJpZXMgb2YgdGhlIGFyZWEgb2YgaW50ZXJlc3Q6XCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShsYXRsbmdzKSk7XG5cbiAgICAgICAgLy8gcHJlcGFyZSB0aGUgcmVzdWx0IHRvIGJlIHVzZWQgZm9yIGNvbnN0cnVjdGluZyBhIHJlY3RhbmdsZVxuICAgICAgICBjb25zdCByZWN0YW5nbGVCb3VuZHM6IEwuTGF0TG5nQm91bmRzID0gTC5sYXRMbmdCb3VuZHMobGF0bG5ncy5tYXAoZnVuY3Rpb24gKGNvb3JkKTogW251bWJlciwgbnVtYmVyXSB7XG4gICAgICAgICAgICByZXR1cm4gW2Nvb3JkLmxhdCwgY29vcmQubG5nXVxuICAgICAgICB9KSk7XG4gICAgICAgIC8vIG1ha2UgdGhlIHJlY3RhbmdsZSwgd2hpY2ggZW5jb21wYXNzZXMgdGhlIGFyZWEgd2hpY2ggd2Ugd2FudCB0byBmaWxsIHdpdGggY2lyY2xlc1xuICAgICAgICBjb25zdCBib3VuZGluZ1JlY3RhbmdsZTogTC5SZWN0YW5nbGUgPSBMLnJlY3RhbmdsZShyZWN0YW5nbGVCb3VuZHMpO1xuXG4gICAgICAgIC8vIHBhc3MgdGhlIHJlY3RhbmdsZSB0byB0aGUgY2FsbGJhY2tcbiAgICAgICAgY2FsbGJhY2tPblJlY3REcmF3bihib3VuZGluZ1JlY3RhbmdsZSk7XG4gICAgfSk7XG4gICAgbWFwLm9uKFwiZHJhdzpkZWxldGVkXCIsIGNhbGxiYWNrT25EZWxldGUpXG5cbn1cblxudmFyIG15UmVuZGVyZXIgPSBMLmNhbnZhcyh7cGFkZGluZzogMC41fSk7XG5cbi8qKlxuICogR2l2ZW4gYSBsYXllciwgY29vcmRpbmF0ZXMgb2YgdGhlIGNlbnRlciBvZiBjaXJjbGVzIGFuZCB0aGUgcmFkaXVzIG9mIHRoZSBjaXJjbGUsXG4gKiBkcmF3IHRoZSBjaXJjbGVzIG9uIHRoZSBsYXllclxuICogQHBhcmFtIHtMYXRMbmdbXX0gY29vcmRzXG4gKiBAcGFyYW0ge0xheWVyR3JvdXB9IGxheWVyXG4gKiBAcGFyYW0ge251bWJlcn0gY2lyY2xlUmFkaXVzXG4gKiBAcGFyYW0ge3t9fSBjaXJjbGVPcHRpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkcmF3Q2lyY2xlcyhjb29yZHM6IEwuTGF0TG5nW10sIGxheWVyOiBMLkxheWVyR3JvdXAsIGNpcmNsZVJhZGl1cyA9IDMwMCwgY2lyY2xlT3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IG9wdHMgPSB7XG4gICAgICAgIGNvbG9yOiBcInJlZFwiLFxuICAgICAgICAuLi5jaXJjbGVPcHRpb25zXG4gICAgfTtcbiAgICBjb29yZHMuZm9yRWFjaCgoY29vcmQ6IEwuTGF0TG5nKSA9PiB7XG4gICAgICAgIEwuY2lyY2xlKGNvb3JkLCB7cmFkaXVzOiBjaXJjbGVSYWRpdXN9LCB7cmVuZGVyZXI6IG15UmVuZGVyZXIsIC4uLmNpcmNsZU9wdGlvbnN9KS5hZGRUbyhsYXllcilcbiAgICB9KVxufVxuXG5cblxuIiwiLypcbiAqICBDcmVkaXRzOiBodHRwOi8vd3d3Lm1vdmFibGUtdHlwZS5jby51ay9zY3JpcHRzL2xhdGxvbmcuaHRtbFxuICogLT4gbGF0bG9uLXNwaGVyaWNhbC5qc1xuICovXG5kZWNsYXJlIGxldCBMO1xuY29uc3QgRUFSVEhfUkFESVVTID0gNjM3MWUzO1xuXG4vKipcbiAqIFwiRGVzdGluYXRpb24gcG9pbnQgZ2l2ZW4gZGlzdGFuY2UgYW5kIGJlYXJpbmcgZnJvbSBzdGFydCBwb2ludFwiXG4gKiBpLmUuIGdpdmVuIGEgcG9pbnQgKGxhdCxsbmcpLCBkaXJlY3Rpb24gYW5kIGRpc3RhbmNlLCBjYWxjdWxhdGUgdGhlIGRlc3RpbmF0aW9uIGNvb3JkaW5hdGVzXG4gKiBDcmVkaXRzOiBodHRwOi8vd3d3Lm1vdmFibGUtdHlwZS5jby51ay9zY3JpcHRzL2xhdGxvbmcuaHRtbFxuICpcbiAqIEBwYXJhbSBjb29yZGluYXRlIDogdGhlIHN0YXJ0IHBvaW50XG4gKiBAcGFyYW0ge251bWJlcn0gZGlzdGFuY2UsIGluIG1ldHJlc1xuICogQHBhcmFtIHtudW1iZXJ9IGJlYXJpbmcgLSBkaXJlY3Rpb24sIGluIGRlZ3JlZXMgZnJvbSBub3J0aCBjbG9ja3dpc2VcbiAqIEByZXR1cm4gdGhlIG5ldyBwb2ludCBhbmQgdGhlIG5ldyBiZWFyaW5nXG4gKiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZU5leHRQb2ludChjb29yZGluYXRlOiBMLkxhdExuZywgZGlzdGFuY2UgPSA1MDAsIGJlYXJpbmcpOiB7IHBvaW50OiBMLkxhdExuZ30ge1xuXG4gICAgbGV0IGRlbHRhID0gTnVtYmVyKGRpc3RhbmNlKSAvIEVBUlRIX1JBRElVUzsgLy8gYW5ndWxhciBkaXN0YW5jZSBpbiByYWRpYW5zXG4gICAgbGV0IHRoZXRhID0gdG9SYWRpYW5zKE51bWJlcihiZWFyaW5nKSk7XG5cbiAgICBsZXQgcGhpMSA9IHRvUmFkaWFucyhjb29yZGluYXRlLmxhdCk7XG4gICAgbGV0IGxhbWJkYTEgPSB0b1JhZGlhbnMoY29vcmRpbmF0ZS5sbmcpO1xuXG4gICAgbGV0IHNpbnBoaTEgPSBNYXRoLnNpbihwaGkxKSwgY29zcGhpMSA9IE1hdGguY29zKHBoaTEpO1xuICAgIGxldCBzaW5kZWx0YSA9IE1hdGguc2luKGRlbHRhKSwgY29zZGVsdGEgPSBNYXRoLmNvcyhkZWx0YSk7XG4gICAgbGV0IHNpbnRoZXRhID0gTWF0aC5zaW4odGhldGEpLCBjb3N0aGV0YSA9IE1hdGguY29zKHRoZXRhKTtcblxuICAgIGxldCBzaW5waGkyID0gc2lucGhpMSAqIGNvc2RlbHRhICsgY29zcGhpMSAqIHNpbmRlbHRhICogY29zdGhldGE7XG4gICAgbGV0IHBoaTIgPSBNYXRoLmFzaW4oc2lucGhpMik7XG4gICAgbGV0IHkgPSBzaW50aGV0YSAqIHNpbmRlbHRhICogY29zcGhpMTtcbiAgICBsZXQgeCA9IGNvc2RlbHRhIC0gc2lucGhpMSAqIHNpbnBoaTI7XG4gICAgbGV0IGxhbWJkYTIgPSBsYW1iZGExICsgTWF0aC5hdGFuMih5LCB4KTtcblxuICAgIGNvbnN0IGRlc3RpbmF0aW9uUG9pbnQgPSBMLmxhdExuZyh0b0RlZ3JlZXMocGhpMiksICh0b0RlZ3JlZXMobGFtYmRhMikgKyA1NDApICUgMzYwIC0gMTgwKTsgLy8gbm9ybWFsaXNlIHRvIOKIkjE4MC4uKzE4MMKwLFxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcG9pbnQ6IGRlc3RpbmF0aW9uUG9pbnRcbiAgICB9XG59XG5cbi8qKlxuICogYG51bWAgaXMgYSBsYXRpdHVkZS9sb25naXR1ZGUgY29vcmRpbmF0ZSBhbmQgYGJvdW5kc2AgaXMgYSBsaW5lLlxuICogVGhpcyBtZXRob2QgY2hlY2tzIGlmIGBudW1gIGlzIHdpdGhpbiB0aGlzIGxpbmUuXG4gKiBFLmcuIHdlIGhhdmUgYSBsaW5lIHRoYXQgZ29lcyBmcm9tIG5vcnRoIHRvIHNvdXRoIC0gZnJvbSBbbGF0OjQwIGxuZzozMF0gdG8gW2xhdDo0MCBsbmc6MjBdIGFuZCB3ZSB3YW50IHRvIGNoZWNrIGlmXG4gKiBsbmc6MjUgaXMgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIGxpbmUuXG4gKiB3aGVuIHVzaW5nIHRoaXMgbWV0aG9kIHRoZSBib3VuZHMgd291bGQgYmUgWzMwLDIwXSBhbmQgbnVtPTI1LlxuICpcbiAqIEBwYXJhbSB7W251bWJlciAsIG51bWJlcl19IGJvdW5kc1xuICogQHBhcmFtIHtudW1iZXJ9IG51bVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzV2l0aGluQm91bmRzKGJvdW5kczogW251bWJlciwgbnVtYmVyXSwgbnVtOiBudW1iZXIpIHtcbiAgICBsZXQgbWluTGF0ID0gTWF0aC5taW4oLi4uYm91bmRzKSwgbWF4TGF0ID0gTWF0aC5tYXgoLi4uYm91bmRzKTtcbiAgICByZXR1cm4gKG1pbkxhdCA8PSBudW0pICYmIChudW0gPD0gbWF4TGF0KTtcbn1cblxuZnVuY3Rpb24gdG9SYWRpYW5zKG51bSkge1xuICAgIHJldHVybiBudW0gKiBNYXRoLlBJIC8gMTgwXG59XG5cbmZ1bmN0aW9uIHRvRGVncmVlcyhudW0pIHtcbiAgICByZXR1cm4gbnVtICogMTgwIC8gTWF0aC5QSVxufVxuXG5cblxuXG4iLCJpbXBvcnQge2NhbGN1bGF0ZU5leHRQb2ludCwgaXNXaXRoaW5Cb3VuZHN9IGZyb20gXCIuL2dlb191dGlsc1wiO1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9DSVJDTEVfUkFESVVTID0gMTUwOyAvLyBtZXRlcnNcbmRlY2xhcmUgbGV0IEw7XG5cbnR5cGUgY3JlYXRlQ29vcmRpbmF0ZXNPcHRzID0ge1xuICAgIGJvdW5kaW5nUmVjdGFuZ2xlOiBMLlJlY3RhbmdsZSxcbiAgICBkaXN0YW5jZTogbnVtYmVyLFxufVxudHlwZSBjcmVhdGVDb29yZGluYXRlc1JldHVybiA9IHsgbWFpbjogTC5MYXRMbmdbXSwgZmlsbGVyczogTC5MYXRMbmdbXSwgY29tYmluZWQ6IEwuTGF0TG5nW10gfTtcblxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIGlzIHRoZSBjb3JlIG9mIHRoZSB3aG9sZSByZXBvLlxuICpcbiAqIFRoZSBmdW5jdGlvbiByZWNlaXZlcyBjcmVhdGVDb29yZGluYXRlc1JldHVybiByZWN0YW5nbGUgYW5kIHdhbnRzIHRvIGZpZ3VyZSBvdXRcbiAqIHRoZSBjb29yZGluYXRlcyBvZiB0aGUgY2VudGVycyBvZiBjaXJjbGVzLCBzdWNoIHRoYXQgdGhlIGNpcmNsZXMgZmlsbCBvdXQgdGhlIHdob2xlIHJlY3RhbmdsZS5cbiAqIFdlIGFsbG93IGZvciB0aGUgY2lyY2xlcyB0byBvdmVybGFwLlxuICpcbiAqIEFsbCBjaXJjbGVzIGRpc2N1c3NlZCBiZWxvdyBoYXZlIHRoZSBzYW1lIHJhZGl1cyAoUiA9IEBvcHRpb25zLmRpc3QvMikuXG4gKlxuICogVGhlIGZ1bmN0aW9uIFwiaXRlcmF0ZXNcIiB0aGUgcmVjdGFuZ2xlIGZyb20gd2VzdC10by1lYXN0LCBub3J0aC10by1zb3V0aC5cbiAqIEEgcm93IGlzIGNyZWF0ZUNvb3JkaW5hdGVzUmV0dXJuIFwibGluZVwiIGZyb20gd2VzdC10by1lYXN0LlxuICpcbiAqIE9uIGVhY2ggcm93IHRoZSBjaXJjbGVzIGFyZSBuZXh0IHRvIGVhY2ggb3RoZXIsIHdpdGhvdXQgb3ZlcmxhcHBpbmcgKGkuZS4gMCBkaXN0YW5jZSBiL3cgY2lyY2xlcyBvbiBjcmVhdGVDb29yZGluYXRlc1JldHVybiByb3cpXG4gKiBUaGVyZSdzIG5vIGRpc3RhbmNlIGJldHdlZW4gY2lyY2xlcyBvbiBhZGphY2VudCBjb2x1bW5zIHRvby5cbiAqIFRoaXMgbWVhbnMgdGhhdCB0aGVzZSBcIm1haW5cIiBjaXJjbGVzIHdpbGwgbm90IGZpbGwgdXAgdGhlIHdob2xlIHJlY3RhbmdsZS5cbiAqXG4gKiBUaHVzLCBiZXR3ZWVuIGVhY2ggdHdvIGFkamFjZW50IFwibWFpblwiIHJvd3MgKGUuZy4gcm93cyBBIGFuZCBCKSAgd2UgaW5zZXJ0IGNyZWF0ZUNvb3JkaW5hdGVzUmV0dXJuIGZpbGxlciByb3cgKEYpLlxuICogUm93IEYgaXMgZWZmZWN0aXZlbHkgY29weSBvZiBBIGJ1dCBzaGlmdGVkIGZpcnN0IHNvdXRoIGFuZCB0aGVuIGVhc3QgYnkgdGhlIHJhZGl1cyBSLiBUaGUgbGFzdCBlbGVtZW50IG9mIHRoZSBmaWxsZXJcbiAqIHJvdyBpcyByZW1vdmVkIHNpbmNlIGl0J3MgdG9vIGZhciBmcm9tIHRoZSBlYXN0IGVuZCBvZiB0aGUgYm91bmRpbmcgcmVjdGFuZ2xlLlxuICpcbiAqIEBwYXJhbSB7Y3JlYXRlQ29vcmRpbmF0ZXNPcHRzfSBvcHRpb25zLiAuZGlzdCBpcyB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgY2VudGVycyBvZiB0d28gY2lyY2xlcy4gaS5lLiBpdCBpcyB0aGUgcmFkaXVzIG9mIGNyZWF0ZUNvb3JkaW5hdGVzUmV0dXJuIGNpcmNsZVxuICogQHJldHVybiB7Y3JlYXRlQ29vcmRpbmF0ZXNSZXR1cm59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDb29yZGluYXRlcyhvcHRpb25zOiBjcmVhdGVDb29yZGluYXRlc09wdHMpOiBjcmVhdGVDb29yZGluYXRlc1JldHVybiB7XG4gICAgY29uc3QgcmVzdWx0OiBMLkxhdExuZ1tdID0gW10sIGZpbGxlcnM6IEwuTGF0TG5nW10gPSBbXTtcblxuICAgIGNvbnN0IHJlY3RCb3VuZHMgPSBvcHRpb25zLmJvdW5kaW5nUmVjdGFuZ2xlLmdldEJvdW5kcygpO1xuICAgIGNvbnN0IGluaXRpYWxQb2ludCA9IE9iamVjdC5mcmVlemUocmVjdEJvdW5kcy5nZXROb3J0aFdlc3QoKSk7XG5cbiAgICBsZXQgY3VycmVudENvb3JkOiBMLkxhdExuZyA9IGluaXRpYWxQb2ludDtcbiAgICBsZXQgY3VycmVudFJvd0luaXRpYWwgPSBjdXJyZW50Q29vcmQ7XG4gICAgZm9yIChsZXQgcm93ID0gMTsgOyByb3crKykge1xuXG4gICAgICAgIGxldCBjdXJyZW50Um93Q2lyY2xlc0Nvb3JkcyA9IGNpcmNsZUNvb3Jkc09mUm93KHJlY3RCb3VuZHMsIGN1cnJlbnRSb3dJbml0aWFsLCBvcHRpb25zLmRpc3RhbmNlKTtcbiAgICAgICAgcmVzdWx0LnB1c2goLi4uY3VycmVudFJvd0NpcmNsZXNDb29yZHMpO1xuXG4gICAgICAgIGxldCBmaWxsZXJGaXJzdENvb3JkID0gbW92ZVRvU291dGhFYXN0KGN1cnJlbnRSb3dJbml0aWFsLCBvcHRpb25zLmRpc3RhbmNlKTtcblxuICAgICAgICBpZiAoIWlzV2l0aGluQm91bmRzKFtyZWN0Qm91bmRzLmdldE5vcnRoKCksIHJlY3RCb3VuZHMuZ2V0U291dGgoKV0sIGN1cnJlbnRDb29yZC5sYXQpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBoZWxwZXJSb3dDb29yZHM6IEwuTGF0TG5nW10gPSBjaXJjbGVDb29yZHNPZlJvdyhyZWN0Qm91bmRzLCBmaWxsZXJGaXJzdENvb3JkLCBvcHRpb25zLmRpc3RhbmNlKTtcbiAgICAgICAgICAgIGhlbHBlclJvd0Nvb3Jkcy5wb3AoKTtcbiAgICAgICAgICAgIGZpbGxlcnMucHVzaCguLi5oZWxwZXJSb3dDb29yZHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3VycmVudFJvd0luaXRpYWwgPSBjdXJyZW50Q29vcmQgPSBjYWxjdWxhdGVOZXh0UG9pbnQoaW5pdGlhbFBvaW50LCBvcHRpb25zLmRpc3RhbmNlICogcm93LCBCZWFyaW5nLnNvdXRoKS5wb2ludDtcbiAgICB9XG4gICAgcmV0dXJuIHttYWluOiByZXN1bHQsIGZpbGxlcnM6IGZpbGxlcnMsIGNvbWJpbmVkOiByZXN1bHQuY29uY2F0KGZpbGxlcnMpfVxuXG59XG5cbi8qKlxuICogKGdlbmVyYXRlcyByb3dzIGZvciBjcmVhdGVDb29yZGluYXRlcygpKVxuICogR2VuZXJhdGUgdGhlIGNvb3JkaW5hdGVzIG9mIGNpcmNsZXMgb24gY3JlYXRlQ29vcmRpbmF0ZXNSZXR1cm4gZ2VuZXJpYyByb3cgKGkuZS4gdXNlZCBmb3IgYm90aCBcIm1haW5cIi9cImZpbGxlclwiIHJvd3MpLlxuICpcbiAqIFRoZSBmdW5jdGlvbiBzdGFydHMgZnJvbSBjcmVhdGVDb29yZGluYXRlc1JldHVybiBnaXZlbiBAaW5pdGlhbENvb3JkIGFuZCBtb3ZlcyBlYXN0LiBPbiBlYWNoIGl0ZXJhdGlvbiBpdCBjaGVja3MgaWYgdGhlIGN1cnJlbnRcbiAqIGNvb3JkaW5hdGUgaXMgd2l0aGluIHRoZSBsb25naXR1ZGUgYm91bmRzIG9mIHRoZSByZWN0IChpLmUuIGF0IG1vc3Qgb25lIGNpcmNsZSBiZXlvbmQgdGhlIGVhc3Qgc2lkZSBvZiB0aGUgcmVjdCkuXG4gKiBJZiBpdCdzIGJleW9uZCAtIHRoZSBmdW5jdGlvbiByZXR1cm5zIHRoZSByb3cuIFNpbmNlIHdlIGFkZCB0byB0aGUgcmVzdWx0IGJlZm9yZSB3ZSBtYWtlIHRoZSBib3VuZCBjaGVjayxcbiAqIHdlIGFsbG93IGZvciBhdCBtb3N0IG9uZSBjaXJjbGUgYmV5b25kIHRoZSBib3VuZHMuXG4gKlxuICogQHBhcmFtIHtMYXRMbmdCb3VuZHN9IGJvdW5kcyAtIHRoZSBib3VuZHMgb2YgdGhlIGJpZyByZWN0YW5nbGUgYXJvdW5kIHRoZSBjaXR5XG4gKiBAcGFyYW0ge0xhdExuZ30gaW5pdGlhbENvb3JkIC0gd2hlcmUgaXMgdGhlIGNlbnRyZSBvZiB0aGUgZmlyc3QgY2lyY2xlIG9uIHRoYXQgcm93XG4gKiBAcGFyYW0gZGlzdGFuY2UgLSB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgY2VudGVycyBvZiB0d28gYWRqYWNlbnQgY2lyY2xlcyBvbiB0aGlzIHJvd1xuICogQHJldHVybiB7TGF0TG5nW119IHRoZSBjb29yZGluYXRlcyBvZiB0aGUgY2VudGVycyBvZiBhbGwgY2lyY2xlcyBvbiB0aGlzIHJvd1xuICovXG5mdW5jdGlvbiBjaXJjbGVDb29yZHNPZlJvdyhib3VuZHM6IEwuTGF0TG5nQm91bmRzLCBpbml0aWFsQ29vcmQ6IEwuTGF0TG5nLCBkaXN0YW5jZSkge1xuICAgIGNvbnN0IGVhc3RCb3VuZCA9IGJvdW5kcy5nZXRFYXN0KCk7XG5cbiAgICBsZXQgcmVzdWx0OiBMLkxhdExuZ1tdID0gW107XG4gICAgbGV0IGN1cnJlbnRQb3NpdGlvbjogTC5MYXRMbmcgPSBpbml0aWFsQ29vcmQ7XG4gICAgZm9yICg7IDspIHtcbiAgICAgICAgcmVzdWx0LnB1c2goY3VycmVudFBvc2l0aW9uKTtcbiAgICAgICAgLypcbiAgICAgICAgdXNlIGluaXRpYWxDb29yZC5sbmcgaW5zdGVhZCBvZiBcIndlc3RCb3VuZFwiIGJlY2F1c2Ugb2YgY3JlYXRlQ29vcmRpbmF0ZXNSZXR1cm4gbnVtZXJpY2FsIGVycm9yIHByb3BhZ2F0ZWQgdXAgZnJvbSBjYWxjdWxhdGVOZXh0UG9pbnQoKS5cbiAgICAgICAgdGhlIGVycm9yIGluY3JlYXNlcyB0aGUgbW9yZSB3ZSBnbyBzb3V0aCBmcm9tIHRoZSBub3J0aC13ZXN0IHBvaW50IG9mIEBib3VuZHMuXG5cbiAgICAgICAgdGw7ZHIgaXQncyBkdWUgdG8gdGhlIGZhY3QgdGhhdCB0aGUgZWFydGggaGFzIGFuIGltcGVyZmVjdCBzaGFwZVxuICAgICAgICAqL1xuICAgICAgICBpZiAoIWlzV2l0aGluQm91bmRzKFtpbml0aWFsQ29vcmQubG5nLCBlYXN0Qm91bmRdLCBjdXJyZW50UG9zaXRpb24ubG5nKSkge1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50UG9zaXRpb24gPSBjYWxjdWxhdGVOZXh0UG9pbnQoY3VycmVudFBvc2l0aW9uLCBkaXN0YW5jZSwgQmVhcmluZy5lYXN0KS5wb2ludDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBtb3ZlVG9Tb3V0aEVhc3QoY3VycmVudFJvd0luaXRpYWwsIGRpc3QpIHtcbiAgICBsZXQgc2hpZnRTb3V0aCA9IGNhbGN1bGF0ZU5leHRQb2ludChjdXJyZW50Um93SW5pdGlhbCwgZGlzdCAvIDIsIEJlYXJpbmcuc291dGgpLnBvaW50O1xuICAgIHJldHVybiBjYWxjdWxhdGVOZXh0UG9pbnQoc2hpZnRTb3V0aCwgZGlzdCAvIDIsIEJlYXJpbmcuZWFzdCkucG9pbnQ7XG59XG5cbi8vIGkuZS4gZGlyZWN0aW9uXG5lbnVtIEJlYXJpbmcge1xuICAgIGVhc3QgPSA5MCxcbiAgICB3ZXN0ID0gLTkwLFxuXG4gICAgbm9ydGggPSAwLFxuICAgIHNvdXRoID0gMTgwXG59XG5cbmVudW0gUmVjdGFuZ2xlU2lkZSB7XG4gICAgLy8gdG9kbyBhZGQgb3RoZXJzXG4gICAgbm9ydGhXZXN0ID0gXCJOb3J0aFdlc3RcIlxufVxuXG5cblxuIiwiaW1wb3J0IHttYXAsIGRyYXdDaXJjbGVzLCBlbmFibGVEcmF3aW5nfSBmcm9tIFwiLi9tYXBcIlxuaW1wb3J0IHtERUZBVUxUX0NJUkNMRV9SQURJVVMsIGNyZWF0ZUNvb3JkaW5hdGVzfSBmcm9tIFwiLi9jb3JlXCJcblxuZGVjbGFyZSBsZXQgJDsgLy8ganF1ZXJ5IGFuZCBsZWFmbGV0IGFyZSBcImltcG9ydGVkXCIgaW4gdGhlIGh0bWwgdmlhIDxzY3JpcHQ+XG5kZWNsYXJlIGxldCBMO1xuXG5cbi8qKlxuICogT3JjaGVzdHJhdGUgaXQgYWxsXG4gKi9cbihmdW5jdGlvbiBydW4oKSB7XG4gICAgLy8gdGhlIGxlYWZsZXQgbGF5ZXIgb24gd2hpY2ggdGhlIGNpcmNsZXMgZ2VuZXJhdGVkIGNpcmNsZXMgd2lsbCBiZSBkcmF3blxuICAgIGNvbnN0IGNpcmNsZXNMYXllciA9IG5ldyBMLkZlYXR1cmVHcm91cCgpLmFkZFRvKG1hcCk7XG5cbiAgICAvLyBzZXQgZGVmYXVsdCBjaXJjbGUgcmFkaXVzXG4gICAgJChcIiNyYWRpdXMtc2l6ZVwiKS5hdHRyKFwidmFsdWVcIiwgREVGQVVMVF9DSVJDTEVfUkFESVVTKTtcblxuICAgIC8vIGF0dGFjaCBhIGNhbGxiYWNrIHRvIHRoZSBldmVudCB3aGVuIGEgdXNlciBoYXMgZHJhd24gYSByZWN0YW5nbGUgb24gdGhlIG1hcC5cbiAgICAvLyB0aGUgZGVmaW5pbmcgY29vcmRzIG9mIHRoZSByZWN0YW5nbGUgYXJlIHRoZW4gcGFzc2VkIHRvIGEgY2FsbGJhY2sgdGhhdCB3ZSBzZXQgaGVyZVxuICAgIGVuYWJsZURyYXdpbmcoXG4gICAgICAgIG9uQ2l0eUJvdW5kYXJ5UmVhZHkuYmluZChudWxsLCBjaXJjbGVzTGF5ZXIpLFxuICAgICAgICBjaXJjbGVzTGF5ZXIuY2xlYXJMYXllcnMpO1xufSkoKTtcblxuLyoqXG4gKiBHaXZlbiBhIGJvdW5kaW5nIHJlY3RhbmdsZSBhbmQgYSBcImNhbnZhc1wiLCBnZW5lcmF0ZWQgdGhlIGNpcmNsZXMgYW5kIGZpbGwgdGhlIGNhbnZhcyB3aXRoIHRoZW1cbiAqXG4gKiBAcGFyYW0ge1JlY3RhbmdsZX0gYm91bmRpbmdSZWN0YW5nbGVcbiAqIEBwYXJhbSBjaXJjbGVzTGF5ZXIgLSB0aGUgXCJjYW52YXNcIlxuICovXG5mdW5jdGlvbiByZWdlbmVyYXRlKGJvdW5kaW5nUmVjdGFuZ2xlOiBMLlJlY3RhbmdsZSwgY2lyY2xlc0xheWVyKSB7XG4gICAgLy8gd2lwZSBvdXQgZXhpc3RpbmcgY2lyY2xlc1xuICAgIGNpcmNsZXNMYXllci5jbGVhckxheWVycygpO1xuXG4gICAgLy8gdGhlIHJhZGl1cyBvZiB0aGUgY2lyY2xlcyB0aGF0IHdpbGwgZmlsbCB0aGUgcmVjdGFuZ2xlXG4gICAgY29uc3QgY2lyY2xlX3JhZGl1cyA9IGdldFVzZXJTZWxlY3RlZENpcmNsZVJhZGl1cygpOyAvLyBtZXRyZXNcbiAgICBjb25zb2xlLmxvZyhgJHtjaXJjbGVfcmFkaXVzfW0gY2lyY2xlIHJhZGl1c2ApO1xuXG4gICAgLy8gZ2VuZXJhdGUgYWxsIHRoZSBjb29yZGluYXRlcyBvZiB0aGUgY2lyY2xlcyB3aXRoaW4gdGhlIGJvdW5kaW5nIGFyZWFcbiAgICAvLyAqb25seSogdGhlIGNvb3JkaW5hdGVzIG9mIHRoZSAqY2VudGVyKiBvZiB0aGUgY2lyY2xlcyBpcyByZXR1cm5lZFxuICAgIGNvbnN0IGNvb3JkcyA9IGNyZWF0ZUNvb3JkaW5hdGVzKHtcbiAgICAgICAgYm91bmRpbmdSZWN0YW5nbGU6IGJvdW5kaW5nUmVjdGFuZ2xlLFxuICAgICAgICBkaXN0YW5jZTogY2lyY2xlX3JhZGl1cyAqIDIsXG4gICAgfSk7XG4gICAgLy8gLm1haW4gJiAuZmlsbGVycyBpcyB1c2VkIHRvIGRlYnVnIGVhc2lseS4gVGhlIHVuaW9uIG9mIHRoZSB0d28gc2V0cyBvZiBjaXJjbGVzXG4gICAgLy8gaXMgaW4gLmNvbWJpbmVkXG4gICAgZHJhd0NpcmNsZXMoY29vcmRzLm1haW4sIGNpcmNsZXNMYXllciwgY2lyY2xlX3JhZGl1cyk7XG4gICAgZHJhd0NpcmNsZXMoY29vcmRzLmZpbGxlcnMsIGNpcmNsZXNMYXllciwgY2lyY2xlX3JhZGl1cywge2NvbG9yOiAnZ3JlZW4nfSk7XG5cbiAgICBsZXQgZG93bmxvYWRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG93bmxvYWQtYnRuJyk7XG5cbiAgICBjb25zb2xlLmxvZyhgR2VuZXJhdGVkICR7Y29vcmRzLmNvbWJpbmVkLmxlbmd0aH0gY2lyY2xlcyBgKTtcblxuICAgIGRvd25sb2FkQnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IHRvU2F2ZSA9IHtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb29yZHMuY29tYmluZWQsXG4gICAgICAgICAgICBjaXJjbGVSYWRpdXM6IGNpcmNsZV9yYWRpdXNcbiAgICAgICAgfTtcbiAgICAgICAgc2F2ZUZpbGUoSlNPTi5zdHJpbmdpZnkodG9TYXZlKSwgYGNvb3Jkc18ke3RvU2F2ZS5jb29yZGluYXRlcy5sZW5ndGh9X3Ike2NpcmNsZV9yYWRpdXN9Lmpzb25gLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgIH07XG59XG5cblxuLyoqXG4gKiBDYWxsZWQgd2hlbiB0aGUgdXNlciBoYXMgZHJhd24gYSByZWN0YW5nbGVcbiAqIEBwYXJhbSBjaXJjbGVzTGF5ZXIgdGhlIGxheWVyIG9uIHdoaWNoIHdlIHdhbnQgdG8gZHJhdyB0aGUgZ2VuZXJhdGVkIGNpcmNsZXNcbiAqIEBwYXJhbSB7TGF0TG5nW119IGRyYXduUmVjdGFuZ2xlXG4gKi9cbmZ1bmN0aW9uIG9uQ2l0eUJvdW5kYXJ5UmVhZHkoY2lyY2xlc0xheWVyLCBkcmF3blJlY3RhbmdsZTogTC5SZWN0YW5nbGUpIHtcbiAgICBjaXJjbGVzTGF5ZXIuY2xlYXJMYXllcnMoKTtcblxuICAgIGNvbnN0IHJlZHJhd0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdlbmVyYXRlLWJ0bicpO1xuICAgIHJlZHJhd0J0bi5vbmNsaWNrID0gcmVnZW5lcmF0ZS5iaW5kKG51bGwsIGRyYXduUmVjdGFuZ2xlLCBjaXJjbGVzTGF5ZXIpO1xuICAgIHJlZHJhd0J0bi5jbGljaygpO1xufVxuXG5mdW5jdGlvbiBnZXRVc2VyU2VsZWN0ZWRDaXJjbGVSYWRpdXMoKSB7XG4gICAgcmV0dXJuIE51bWJlcigkKFwiI3JhZGl1cy1zaXplXCIpLnZhbCgpKTtcbn1cblxuXG4vKipcbiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMzU0MjQ5OVxuICogU2F2ZSBhIGZpbGUgdG8gdGhlIGxvY2FsIGZpbGVzeXN0ZW1cbiAqIEBwYXJhbSBkYXRhXG4gKiBAcGFyYW0gZmlsZW5hbWVcbiAqIEBwYXJhbSBjb250ZW50VHlwZVxuICovXG5mdW5jdGlvbiBzYXZlRmlsZShkYXRhLCBmaWxlbmFtZSwgY29udGVudFR5cGUpIHtcbiAgICBsZXQgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSwge3R5cGU6IGNvbnRlbnRUeXBlfSk7XG4gICAgaWYgKHdpbmRvdy5uYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYikge1xuICAgICAgICB3aW5kb3cubmF2aWdhdG9yLm1zU2F2ZUJsb2IoYmxvYiwgZmlsZW5hbWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbGV0IGVsZW0gPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICBlbGVtLmhyZWYgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgICAgZWxlbS5kb3dubG9hZCA9IGZpbGVuYW1lO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW0pO1xuICAgICAgICBlbGVtLmNsaWNrKCk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbSk7XG4gICAgfVxufVxuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0=